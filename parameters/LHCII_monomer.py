#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
Created on Mon Sep 21 21:43:12 2020

@author: LiwenKo
"""

#from PSII import PSII
import numpy as np

#psii = PSII()
#m = psii.masks['LHCIIA_Top']
#H_sys = psii.H[m,:][:,m]
#dipoles = psii.dipoles[m,:]
#chl_names = np.array(psii.chl_names)[m]
#lambdas = np.zeros(np.size(chl_names))
#gammas = np.zeros(np.size(chl_names))
#for j in range(len(chl_names)):
#    if chl_names[j][:3] == 'CLA':
#        lambdas[j] = 37
#        gammas[j] = 30
#    elif chl_names[j][:3] == 'CHL':
#        lambdas[j] = 37
#        gammas[j] = 48


lambdas = np.array([37., 37., 37., 37., 37., 37., 37., 37., 37., 37., 37., 37., 37.,
       37.])

gammas = np.array([48., 30., 30., 30., 48., 48., 48., 48., 48., 30., 30., 30., 30.,
       30.])
    
H_sys = np.array([[ 1.5889e+04,  4.9640e+01, -5.8900e+00, -2.5100e+00,  7.7000e-01,
        -1.8700e+00, -2.4900e+00,  2.7800e+00,  3.7900e+00, -5.9500e+00,
         2.4890e+01,  9.1300e+00, -1.0790e+01,  3.5900e+00],
       [ 4.9640e+01,  1.5157e+04,  3.8110e+01,  6.4200e+00, -7.1000e-01,
         5.6000e+00,  7.1300e+00, -5.8400e+00, -1.9250e+01, -1.1390e+01,
         9.6900e+00,  1.5830e+01, -4.9600e+00,  6.9000e-01],
       [-5.8900e+00,  3.8110e+01,  1.5287e+04, -3.2800e+00,  1.1300e+00,
        -8.8900e+00,  1.2300e+00,  6.7200e+00,  9.6660e+01,  1.2970e+01,
        -2.7000e+00, -7.6000e-01,  2.6800e+00, -6.7000e+00],
       [-2.5100e+00,  6.4200e+00, -3.2800e+00,  1.5460e+04,  3.3500e+00,
         1.0456e+02,  3.5930e+01, -2.7600e+00, -7.2800e+00, -4.1800e+00,
        -3.8000e+00,  4.6700e+00,  2.1200e+00, -3.4200e+00],
       [ 7.7000e-01, -7.1000e-01,  1.1300e+00,  3.3500e+00,  1.5679e+04,
         2.9710e+01, -4.4700e+00, -5.1300e+00, -7.7000e-01,  1.6100e+00,
         1.3300e+00, -2.8500e+00, -1.4000e+00,  3.7000e-01],
       [-1.8700e+00,  5.6000e+00, -8.8900e+00,  1.0456e+02,  2.9710e+01,
         1.5850e+04,  5.9380e+01, -4.9900e+00, -1.6000e-01, -3.2800e+00,
        -2.5200e+00,  3.1000e+00,  1.4700e+00, -2.1600e+00],
       [-2.4900e+00,  7.1300e+00,  1.2300e+00,  3.5930e+01, -4.4700e+00,
         5.9380e+01,  1.5714e+04, -4.4300e+00, -1.1990e+01, -1.4000e-01,
        -2.7800e+00,  3.0700e+00,  2.2000e+00, -3.2500e+00],
       [ 2.7800e+00, -5.8400e+00,  6.7200e+00, -2.7600e+00, -5.1300e+00,
        -4.9900e+00, -4.4300e+00,  1.5761e+04,  3.6070e+01,  6.1970e+01,
         4.3500e+00, -1.0800e+00, -2.0100e+00,  1.3000e+00],
       [ 3.7900e+00, -1.9250e+01,  9.6660e+01, -7.2800e+00, -7.7000e-01,
        -1.6000e-01, -1.1990e+01,  3.6070e+01,  1.5721e+04,  3.8600e+00,
         4.3000e+00, -2.5700e+00, -2.9200e+00,  2.3300e+00],
       [-5.9500e+00, -1.1390e+01,  1.2970e+01, -4.1800e+00,  1.6100e+00,
        -3.2800e+00, -1.4000e-01,  6.1970e+01,  3.8600e+00,  1.5073e+04,
        -2.4960e+01,  2.3100e+01,  7.2100e+00, -1.5500e+00],
       [ 2.4890e+01,  9.6900e+00, -2.7000e+00, -3.8000e+00,  1.3300e+00,
        -2.5200e+00, -2.7800e+00,  4.3500e+00,  4.3000e+00, -2.4960e+01,
         1.5112e+04,  1.2692e+02, -6.1500e+00,  4.5500e+00],
       [ 9.1300e+00,  1.5830e+01, -7.6000e-01,  4.6700e+00, -2.8500e+00,
         3.1000e+00,  3.0700e+00, -1.0800e+00, -2.5700e+00,  2.3100e+01,
         1.2692e+02,  1.5094e+04, -4.7000e-01, -1.8000e-01],
       [-1.0790e+01, -4.9600e+00,  2.6800e+00,  2.1200e+00, -1.4000e+00,
         1.4700e+00,  2.2000e+00, -2.0100e+00, -2.9200e+00,  7.2100e+00,
        -6.1500e+00, -4.7000e-01,  1.5174e+04, -5.0220e+01],
       [ 3.5900e+00,  6.9000e-01, -6.7000e+00, -3.4200e+00,  3.7000e-01,
        -2.1600e+00, -3.2500e+00,  1.3000e+00,  2.3300e+00, -1.5500e+00,
         4.5500e+00, -1.8000e-01, -5.0220e+01,  1.5260e+04]])

dipoles = np.array([[ 3.04018928,  1.51919464,  0.09641966],
       [-1.42230404, -3.46070983,  1.41440402],
       [ 2.58738817,  2.60418809,  1.58859273],
       [ 1.81480538, -2.10130623, -2.87940854],
       [-0.29193785, -1.81308663,  2.86137889],
       [ 2.62012348,  0.01673115, -2.16671942],
       [ 1.55037969,  1.03298647, -2.84416275],
       [-2.98160121, -1.07250043,  1.2328005 ],
       [-2.08379809, -2.66109756,  0.36924966],
       [ 1.77671903,  3.27783512,  1.44881552],
       [ 2.58650849,  3.04210998,  0.23567077],
       [-2.46647094, -2.26807328,  2.18457426],
       [-1.96630894,  2.09060951, -2.78621267],
       [-0.5585345 ,  3.51332832,  1.82881474]])

# singular values: [112.35315131,  29.85706657,  55.1497822 ]
# SVD polarizations:
# [ 0.63345607,  0.7415613 , -0.22095305]
# [ 0.74809864, -0.51397872,  0.41973122]
# [-0.19769127,  0.43117596,  0.88034394]

#import numpy as np
#from numpy import matmul
#polarization = np.array([ 0.63345607,  0.7415613 , -0.22095305])
#B_unnorm = matmul(dipoles, polarization)
#B_norm = B_unnorm/np.linalg.norm(B_unnorm)
#ctrfreq = np.average(np.diag(H_sys))
#I = np.identity(14)
#eigvals, eigvecs = np.linalg.eig(H_sys-ctrfreq*I)
#overlap_sq = np.square(np.abs(matmul(B_norm, eigvecs)))
#energy_sq = np.square(eigvals)
#delta = np.sqrt(matmul(overlap_sq, energy_sq))
#print('delta =', str(delta))
#from math import pi
#cm_to_fs = 1e5/(6*pi)
#WWgamma_cm = 1.0719291822450668e-05
#Gamma_inc = WWgamma_cm * matmul(B_unnorm, B_unnorm)*0.11
